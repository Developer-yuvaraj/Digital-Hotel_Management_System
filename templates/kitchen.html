<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kitchen Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.tailwindcss.com"></script>

<style>
.column{
  background:#fff;
  border-radius:16px;
  padding:16px;
  min-height:70vh;
}
.badge{
  font-size:12px;
  padding:4px 10px;
  border-radius:999px;
  font-weight:600;
}

.column {
  border-radius: 18px;
  padding: 16px;
  height: calc(100vh - 140px); /* screen height based */
  overflow-y: auto;
  scrollbar-width: thin;
}

/* nice scrollbar */
.column::-webkit-scrollbar {
  width: 6px;
}
.column::-webkit-scrollbar-thumb {
  background: #c7c7c7;
  border-radius: 10px;
}


</style>
</head>

<body class="bg-gradient-to-br from-[#FFF5F5] to-[#F0F9FF] text-gray-800">

<!-- HEADER -->
<header class="bg-gradient-to-r from-red-500 to-orange-500 shadow sticky top-0 z-50">
  <div class="max-w-7xl mx-auto p-4 flex justify-between items-center text-white">

    <!-- LEFT -->
    <div>
      <h1 class="text-xl font-bold flex items-center gap-2">
        ğŸ³ Kitchen Dashboard
      </h1>
      <p class="text-xs opacity-90">Live Order Management</p>
    </div>

    <!-- RIGHT -->
    <div class="flex items-center gap-4">
      <span class="hidden sm:block text-sm bg-white/20 px-3 py-1 rounded-full">
        ğŸ” Logged in
      </span>

      <a href="/kitchen-logout"
       class="bg-white text-red-600 px-4 py-2 rounded-lg
              font-semibold text-sm shadow hover:bg-red-100 transition">
        ğŸšª Logout
      </a>
    </div>

  </div>
</header>


<!-- MAIN GRID -->
<div class="max-w-7xl mx-auto p-6 grid grid-cols-1 md:grid-cols-3 gap-6">

<!-- ================= NEW ORDERS ================= -->
<div class="column bg-gradient-to-b from-red-50 to-white border-t-4 border-red-500">

  <h2 class="text-lg font-bold text-red-500 mb-4">ğŸ†• New Orders</h2>

  {% for o in orders if o.status == 'Pending' %}
  <div class="bg-red-50 rounded-xl p-4 mb-4 shadow">
    <div class="flex justify-between mb-1">
      <b>ğŸ‘¤ {{ o.customer_name }}</b>
      <span class="badge bg-red-200 text-red-700">Pending</span>
    </div>
    <p class="text-sm mb-1">ğŸª‘ Table {{ o.table_name }}</p>

<div class="bg-white p-2 rounded text-sm mb-2">
  ğŸ½
  <ul class="list-disc ml-4">
    {% for name, d in o.items_parsed.items() %}
      <li>{{ name }} Ã— {{ d.qty }}</li>
    {% endfor %}
  </ul>
</div>


    <p class="text-sm font-semibold mb-2">
      Total â‚¹{{ o.total }}
    </p>

    <button
      data-id="{{ o.id }}" data-status="Accepted"
      onclick="setStatus(this)"
      class="w-full bg-blue-500 text-white py-2 rounded-lg font-semibold">
      Accept Order
    </button>
  </div>
  {% endfor %}
</div>

<!-- ================= COOKING ================= -->
<div class="column bg-gradient-to-b from-orange-50 to-white border-t-4 border-orange-500">

  <h2 class="text-lg font-bold text-orange-500 mb-4">ğŸ³ Cooking</h2>

  {% for o in orders if o.status == 'Accepted' or o.status == 'Cooking' %}
  <div class="bg-orange-50 rounded-xl p-4 mb-4 shadow">
    <div class="flex justify-between mb-1">
      <b>ğŸ‘¤ {{ o.customer_name }}</b>
      <span class="badge bg-orange-200 text-orange-700">Cooking</span>
    </div>
    <p class="text-sm mb-1">ğŸª‘ Table {{ o.table_name }}</p>

 <div class="bg-white p-2 rounded text-sm mb-2">
  ğŸ½
  <ul class="list-disc ml-4">
    {% for name, d in o.items_parsed.items() %}
      <li>{{ name }} Ã— {{ d.qty }}</li>
    {% endfor %}
  </ul>
</div>


    <p class="text-sm font-semibold mb-2">
      Total â‚¹{{ o.total }}
    </p>

    <div class="flex gap-2">
      <button
        data-id="{{ o.id }}" data-status="Cooking"
        onclick="setStatus(this)"
        class="flex-1 bg-orange-500 text-white py-2 rounded">
        Cooking
      </button>

      <button
        data-id="{{ o.id }}" data-status="Done"
        onclick="setStatus(this)"
        class="flex-1 bg-green-600 text-white py-2 rounded font-bold">
        Done
      </button>
    </div>
  </div>
  {% endfor %}
</div>

<!-- ================= DONE ================= -->
<div class="column bg-gradient-to-b from-green-50 to-white border-t-4 border-green-500">

  <h2 class="text-lg font-bold text-green-600 mb-4">âœ… Done</h2>

  {% for o in orders if o.status == 'Done' %}
  <div class="bg-green-50 rounded-xl p-4 mb-4 shadow">
    <div class="flex justify-between mb-1">
      <b>ğŸ‘¤ {{ o.customer_name }}</b>
      <span class="badge bg-green-200 text-green-700">Done</span>
    </div>
    <p class="text-sm mb-1">ğŸª‘ Table {{ o.table_name }}</p>

   <div class="bg-white p-2 rounded text-sm mb-2">
  ğŸ½
  <ul class="list-disc ml-4">
    {% for name, d in o.items_parsed.items() %}
      <li>{{ name }} Ã— {{ d.qty }}</li>
    {% endfor %}
  </ul>
</div>


    <p class="text-sm font-semibold">
      Total â‚¹{{ o.total }}
    </p>

    <p class="text-xs text-gray-400 mt-2">
      â± {{ o.created_at }}
    </p>
  </div>
  {% endfor %}
</div>

</div>

<!-- JS -->
<script>
function setStatus(btn){
  const id = btn.dataset.id;
  const status = btn.dataset.status;

  fetch("/api/update-status",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({id,status})
  }).then(()=>location.reload());
}
</script>

</body>
</html>
